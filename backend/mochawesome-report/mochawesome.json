{
  "stats": {
    "suites": 3,
    "tests": 13,
    "passes": 13,
    "pending": 0,
    "failures": 0,
    "start": "2025-11-08T19:06:24.131Z",
    "end": "2025-11-08T19:06:26.307Z",
    "duration": 2176,
    "testsRegistered": 13,
    "passPercent": 100,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false
  },
  "results": [
    {
      "uuid": "201e50d3-2214-4373-928e-c76303fc96bd",
      "title": "",
      "fullFile": "",
      "file": "",
      "beforeHooks": [],
      "afterHooks": [],
      "tests": [],
      "suites": [
        {
          "uuid": "5e35726a-f30a-4714-809d-facbeaa60fec",
          "title": "Clicks API",
          "fullFile": "C:\\Users\\Put_2\\Documents\\PK\\WOrk\\Dev\\Jewery\\backend\\tests\\clicks.test.js",
          "file": "\\tests\\clicks.test.js",
          "beforeHooks": [
            {
              "title": "\"before all\" hook in \"Clicks API\"",
              "fullTitle": "Clicks API \"before all\" hook in \"Clicks API\"",
              "timedOut": false,
              "duration": 875,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await initDB();\n// Login as admin to get token\nconst res = await request.post(\"/api/users/login\").send({\n  email: \"admin@example.com\",\n  password: \"Admin1234\"\n});\nauthToken = res.body.token;",
              "err": {},
              "uuid": "1d871e65-e93a-4d48-aabb-a365f391cf0c",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [
            {
              "title": "\"after all\" hook in \"Clicks API\"",
              "fullTitle": "Clicks API \"after all\" hook in \"Clicks API\"",
              "timedOut": false,
              "duration": 37,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "// Clean up test clicks\nawait Click.deleteMany({ $or: [{ userId: testUserId }, { productId: testProductId }] });",
              "err": {},
              "uuid": "6080bbba-19be-4385-82ca-eae21fcd2bff",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": true,
              "skipped": false
            }
          ],
          "tests": [
            {
              "title": "POST /api/clicks/history should record a user view",
              "fullTitle": "Clicks API POST /api/clicks/history should record a user view",
              "timedOut": false,
              "duration": 149,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .post(\"/api/clicks/history\")\n  .set(\"Authorization\", `Bearer ${authToken}`)\n  .send({ userId: testUserId, productId: testProductId });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(\"message\").that.includes(\"updated successfully\");",
              "err": {},
              "uuid": "66f4eff3-18b0-4809-ad09-f243140c2904",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "GET /api/clicks/history/:userId should return user view history",
              "fullTitle": "Clicks API GET /api/clicks/history/:userId should return user view history",
              "timedOut": false,
              "duration": 76,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .get(`/api/clicks/history/${testUserId}`)\n  .set(\"Authorization\", `Bearer ${authToken}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(\"array\");\nif (res.body.length > 0) {\n  expect(res.body[0]).to.have.property(\"type\", \"history\");\n  expect(res.body[0]).to.have.property(\"productId\");\n}",
              "err": {},
              "uuid": "a5807c3b-290b-41e7-abf3-ec0e28a9a8f3",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "DELETE /api/clicks/history/:userId should clear user view history",
              "fullTitle": "Clicks API DELETE /api/clicks/history/:userId should clear user view history",
              "timedOut": false,
              "duration": 39,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .delete(`/api/clicks/history/${testUserId}`)\n  .set(\"Authorization\", `Bearer ${authToken}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(\"message\").that.includes(\"cleared\");",
              "err": {},
              "uuid": "924b36d7-363b-4283-aa4f-cadf424e640c",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "POST /api/clicks/product should record a product click",
              "fullTitle": "Clicks API POST /api/clicks/product should record a product click",
              "timedOut": false,
              "duration": 73,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .post(\"/api/clicks/product\")\n  .set(\"Authorization\", `Bearer ${authToken}`)\n  .send({ productId: testProductId });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(\"message\").that.includes(\"recorded\");",
              "err": {},
              "uuid": "b0ff3558-2d3a-4be4-bbd6-f0dfcb963b23",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "GET /api/clicks/product/:productId should return product clicks",
              "fullTitle": "Clicks API GET /api/clicks/product/:productId should return product clicks",
              "timedOut": false,
              "duration": 37,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .get(`/api/clicks/product/${testProductId}`)\n  .set(\"Authorization\", `Bearer ${authToken}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property(\"productId\", testProductId);\nexpect(res.body).to.have.property(\"totalClicks\").that.is.a(\"number\");",
              "err": {},
              "uuid": "46a78f3e-2d2c-405f-aaae-5300b9aab22a",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "GET /api/clicks/ should return all clicks",
              "fullTitle": "Clicks API GET /api/clicks/ should return all clicks",
              "timedOut": false,
              "duration": 75,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .get(\"/api/clicks/\")\n  .set(\"Authorization\", `Bearer ${authToken}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(\"array\");",
              "err": {},
              "uuid": "57d5a738-0ee3-4d90-a350-3058a8593582",
              "parentUUID": "5e35726a-f30a-4714-809d-facbeaa60fec",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "66f4eff3-18b0-4809-ad09-f243140c2904",
            "a5807c3b-290b-41e7-abf3-ec0e28a9a8f3",
            "924b36d7-363b-4283-aa4f-cadf424e640c",
            "b0ff3558-2d3a-4be4-bbd6-f0dfcb963b23",
            "46a78f3e-2d2c-405f-aaae-5300b9aab22a",
            "57d5a738-0ee3-4d90-a350-3058a8593582"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 449,
          "root": false,
          "rootEmpty": false,
          "_timeout": 2000
        },
        {
          "uuid": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
          "title": "Products API",
          "fullFile": "C:\\Users\\Put_2\\Documents\\PK\\WOrk\\Dev\\Jewery\\backend\\tests\\products.test.js",
          "file": "\\tests\\products.test.js",
          "beforeHooks": [
            {
              "title": "\"before all\" hook in \"Products API\"",
              "fullTitle": "Products API \"before all\" hook in \"Products API\"",
              "timedOut": false,
              "duration": 232,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await initDB();\n// Login as admin to get token\nconst res = await request.post('/api/users/login').send({\n  email: 'admin@example.com',\n  password: 'Admin1234'\n});\nauthToken = res.body.token;",
              "err": {},
              "uuid": "d946f7a3-0e23-4895-ad6d-2f958c8a3dbd",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [
            {
              "title": "\"after all\" hook in \"Products API\"",
              "fullTitle": "Products API \"after all\" hook in \"Products API\"",
              "timedOut": false,
              "duration": 33,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "// Clean up test products\nawait Product.deleteMany({ name: /Test Product/ });",
              "err": {},
              "uuid": "95174a21-528e-4648-b186-ebe4ba695da4",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": true,
              "skipped": false
            }
          ],
          "tests": [
            {
              "title": "GET /api/products should return all products",
              "fullTitle": "Products API GET /api/products should return all products",
              "timedOut": false,
              "duration": 39,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request.get('/api/products');\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an('array');",
              "err": {},
              "uuid": "e5ca253b-6756-4ba6-ad80-497cf4a8c2cc",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "POST /api/products should create a new product",
              "fullTitle": "Products API POST /api/products should create a new product",
              "timedOut": false,
              "duration": 45,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const timestamp = Date.now();\nconst newProduct = {\n  code: `TEST-${timestamp}`,\n  name: `Test Product ${timestamp}`,\n  description: 'Test description',\n  category: 'Test',\n  price: 9.99,\n  material: 'Test Material',\n  weight: 1.5,\n  stock: 10\n};\nconst res = await request\n  .post('/api/products')\n  .set('Authorization', `Bearer ${authToken}`)\n  .send(newProduct);\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('product');\nexpect(res.body.product).to.have.property('_id');\nexpect(res.body.product.name).to.equal(newProduct.name);\ncreatedProductId = res.body.product._id; // save ID for future tests",
              "err": {},
              "uuid": "253018a6-c07c-40f3-8470-de1ae3bd99b5",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "GET /api/products/:id should return the created product",
              "fullTitle": "Products API GET /api/products/:id should return the created product",
              "timedOut": false,
              "duration": 35,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request.get(`/api/products/${createdProductId}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property('_id', createdProductId);",
              "err": {},
              "uuid": "1b0a82b7-ba6c-4433-9be9-f0d77b2bda22",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "PUT /api/products/:id should update the product",
              "fullTitle": "Products API PUT /api/products/:id should update the product",
              "timedOut": false,
              "duration": 41,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .put(`/api/products/${createdProductId}`)\n  .set('Authorization', `Bearer ${authToken}`)\n  .send({ price: 19.99 });\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property('product');\nexpect(res.body.product.price).to.equal(19.99);",
              "err": {},
              "uuid": "ae1df152-f95f-4e0c-a924-0bf24b5931cd",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "DELETE /api/products/:id should delete the product",
              "fullTitle": "Products API DELETE /api/products/:id should delete the product",
              "timedOut": false,
              "duration": 40,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request\n  .delete(`/api/products/${createdProductId}`)\n  .set('Authorization', `Bearer ${authToken}`);\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property('message').that.includes('deleted');",
              "err": {},
              "uuid": "f653e120-b720-4602-8a6b-09eebaa4825a",
              "parentUUID": "ac27d231-9b8e-4910-9292-73a3ea6cea57",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "e5ca253b-6756-4ba6-ad80-497cf4a8c2cc",
            "253018a6-c07c-40f3-8470-de1ae3bd99b5",
            "1b0a82b7-ba6c-4433-9be9-f0d77b2bda22",
            "ae1df152-f95f-4e0c-a924-0bf24b5931cd",
            "f653e120-b720-4602-8a6b-09eebaa4825a"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 200,
          "root": false,
          "rootEmpty": false,
          "_timeout": 2000
        },
        {
          "uuid": "713492e3-c294-4a7d-bac7-168f45a0b11f",
          "title": "Users API",
          "fullFile": "C:\\Users\\Put_2\\Documents\\PK\\WOrk\\Dev\\Jewery\\backend\\tests\\users.test.js",
          "file": "\\tests\\users.test.js",
          "beforeHooks": [
            {
              "title": "\"before all\" hook in \"Users API\"",
              "fullTitle": "Users API \"before all\" hook in \"Users API\"",
              "timedOut": false,
              "duration": 131,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await initDB();",
              "err": {},
              "uuid": "ca046d45-ceec-49cc-b5ac-c72989d14f4c",
              "parentUUID": "713492e3-c294-4a7d-bac7-168f45a0b11f",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [
            {
              "title": "\"after all\" hook in \"Users API\"",
              "fullTitle": "Users API \"after all\" hook in \"Users API\"",
              "timedOut": false,
              "duration": 36,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "await User.deleteMany({ email: /testuser/ });",
              "err": {},
              "uuid": "c6a9a2b5-7820-4127-a4a0-2bea97ae3259",
              "parentUUID": "713492e3-c294-4a7d-bac7-168f45a0b11f",
              "isHook": true,
              "skipped": false
            }
          ],
          "tests": [
            {
              "title": "GET /api/users should return all users",
              "fullTitle": "Users API GET /api/users should return all users",
              "timedOut": false,
              "duration": 36,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const res = await request.get(\"/api/users\");\nexpect(res.status).to.equal(200);\nexpect(res.body).to.be.an(\"array\");",
              "err": {},
              "uuid": "ddb4be1a-0c2f-47c4-b249-1981e417c8a6",
              "parentUUID": "713492e3-c294-4a7d-bac7-168f45a0b11f",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "POST /api/users/register should create a new user",
              "fullTitle": "Users API POST /api/users/register should create a new user",
              "timedOut": false,
              "duration": 132,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const newUser = {\n  title: \"Mr.\", // <- note the dot\n  firstName: \"Test\",\n  lastName: \"User\",\n  age: 25,\n  email: `testuser${Date.now()}@example.com`,\n  password: \"Test1234\",\n  phone: \"0123456789\",\n  role: \"user\",\n};\nconst res = await request.post(\"/api/users/register\").send(newUser);\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('message', \"User registered successfully.\");",
              "err": {},
              "uuid": "b1c8f942-6848-4b73-bfa9-5018f9f50aa0",
              "parentUUID": "713492e3-c294-4a7d-bac7-168f45a0b11f",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "ddb4be1a-0c2f-47c4-b249-1981e417c8a6",
            "b1c8f942-6848-4b73-bfa9-5018f9f50aa0"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 168,
          "root": false,
          "rootEmpty": false,
          "_timeout": 2000
        }
      ],
      "passes": [],
      "failures": [],
      "pending": [],
      "skipped": [],
      "duration": 0,
      "root": true,
      "rootEmpty": true,
      "_timeout": 2000
    }
  ],
  "meta": {
    "mocha": {
      "version": "11.7.5"
    },
    "mochawesome": {
      "options": {
        "quiet": false,
        "reportFilename": "mochawesome",
        "saveHtml": true,
        "saveJson": true,
        "consoleReporter": "spec",
        "useInlineDiffs": false,
        "code": true
      },
      "version": "7.1.4"
    },
    "marge": {
      "options": null,
      "version": "6.3.2"
    }
  }
}